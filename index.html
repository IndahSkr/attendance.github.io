<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <link rel="stylesheet" href="./node_modules/font-awesome/css/font-awesome.css">
  <!-- <link rel="stylesheet" href="../library/AdminLTE-3.2.0/plugins/icheck-bootstrap/icheck-bootstrap.min.css"> -->
  <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.css">
  <style>
    .loader {
      width: 48px;
      height: 48px;
      display: block;
      margin: 20px auto;
      box-sizing: border-box;
      position: relative;
    }
    .loader::after {
      content: '';  
      box-sizing: border-box;
      width: 48px;
      height: 48px;
      left: 0;
      bottom: 0;
      position: absolute;
      border-radius: 50% 50% 0;
      border: 15px solid #FFF;
      transform: rotate(45deg) translate(0, 0);
      box-sizing: border-box;
      animation: animMarker 0.4s ease-in-out infinite alternate;
    }
    .loader::before {
      content: '';  
      box-sizing: border-box;
      position: absolute;
      left: 0;
      right: 0;
      margin: auto;
      top: 150%;
      width: 24px;
      height: 4px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.2);
      animation: animShadow 0.4s ease-in-out infinite alternate;
    }

    @keyframes animMarker {
      0% {
        transform: rotate(45deg) translate(5px, 5px);
      }
      100% {
        transform: rotate(45deg) translate(-5px, -5px);
      }
    }

    @keyframes animShadow {
      0% {
        transform: scale(0.5);
      }
      100% {
        transform: scale(1);
      }
    }
  
  </style>
</head>
<body style="background-color: #508a71">
  <div class="container d-flex justify-content-center align-items-center min-vh-100">
    <!-- Loader Start -->
      <div class="loader" id='loader'></div>
    <!-- Loader Stop -->

    <!-- Content Start -->
    <div class="card p-4" style="background-color: #83b89e;" id="cardContent" hidden>
      <div class="text-center m-1">
        <img src="./assets/images/logo-rsi-only.png" class="img-fluid" id="lgimg" style="height: 80px;" alt="Hospital logo"
          hidden>
      </div>
      <form action="#">
        <div class="mb-2">
          <label for="lat" class="form-label m-0" id="lblLat" hidden><strong>Latitude</strong></label>
          <input type="text" class="form-control" id="lat" aria-describedby="lat" hidden>
        </div>
        <div class="mb-2">
          <label for="long" class="form-label m-0" id="lblLong" hidden><strong>Longitude</strong></label>
          <input type="text" class="form-control" id="long" aria-describedby="long" hidden>
        </div>
        <!-- <div class="mb-2 form-check" hidden>
          <input type="checkbox" class="form-check-input" id="showPw">
          <label class="form-check-label" for="showPw">Show password!</label>
        </div> -->
      </form>
      </div>
    <!-- Content Stop -->

  </div>

<!-- jQuery -->
<script src="./node_modules/jquery/dist/jquery.min.js"></script>
<script src="./node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
<script>

  window.onload = function () {
    getLocation();
  }

  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        // Callback
        (position) => {
          // the coordinate
          const lat = position.coords.latitude;
          const long = position.coords.longitude;
          const acc = position.coords.accuracy;

          resultLoc(lat, long, acc);
        },
        // Callback error
        (error) => {
          let errorMessege = "Something wrong when get location. Try again";

          switch (error.code) {
            case error.PERMISSION_DENIED:
              // user block geolocation permission
              errorMessege = "You denied location permission. Loacation-based presence requires location access";
              break;
            case error.POSITION_UNAVAILABLE:
              // location can't be determined (e.g. GPS is off) 
              errorMessege = "Your information is not available. Make sure your location feature is anabled."
              break;
            case error.TIMEOUT:
              // Request timed out before location was obtained
              errorMessege = "Request time out. Please Try Again."
              break;
            case error.UNKNOWN_ERROR:
              // unexpected error
              errorMessege = "An unexpected error occurred while getting location";
              break;
          }
          alert(`Sorry! ${errorMessege}`);
          resultLoc(null, null, null, errorMessege);
        },
        {
          enableHighAccuracy: true,
          timeout: 10000,
          maximumAge: 0
        }
      );
    } else {
      // browser does not support geolocation
      const messege = "Your browser doesn't support Geolocation";
      // console.error(messege);
      resultLoc(null, null, null, messege);
    }
  }

  function resultLoc(lat, long, acc, err = null) {
    const elementInfo = document.getElementById('loader');
    elementInfo.hidden = true;
    if (!infoElement) return;

    if (error) {
      // infoElement.innerHTML = `<p style="color: red;">${error}</p>`;
      alert(`Sorry! ${error}`);
    } else if (lintang !== null && bujur !== null) {
      // elementInfo.hidden = true;
      document.getElementById('cardContent').hidden = true;
      document.getElementById('lgimg').hidden = true;
      document.getElementById('lblLat').hidden = true;
      document.getElementById('lat').hidden = true;
      document.getElementById('lat').value = lintang;
      document.getElementById('lblLong').hidden = true;
      document.getElementById('long').hidden = true;
      document.getElementById('long').value = bujur;
    } else {
      // infoElement.innerHTML = `<p>Menunggu permintaan lokasi...</p>`;
      alert(`Sorry! Waiting`);
    }
  }
</script>
</body>
</html>